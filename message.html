<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UPLINK | Secure Terminal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;500;700&display=swap');
        
        body { 
            background-color: #020617; 
            color: #e2e8f0; 
            font-family: 'Space Grotesk', sans-serif;
            overflow: hidden; 
        }

        .glass { background: rgba(15, 23, 42, 0.8); backdrop-filter: blur(12px); }
        .cyber-border { border: 1px solid rgba(59, 130, 246, 0.2); }
        .glow-blue:hover { box-shadow: 0 0 15px rgba(59, 130, 246, 0.4); }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 5px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #1e3a8a; border-radius: 10px; }

        /* Hidden Trays */
        .drawer-hide { transform: translateY(100%); transition: transform 0.3s ease; }
        .drawer-show { transform: translateY(0); }
    </style>
</head>
<body class="h-screen flex flex-col">

    <div id="username-modal" class="fixed inset-0 z-[100] flex items-center justify-center bg-[#020617]">
        <div class="p-8 w-full max-w-md text-center animate-pulse">
            <div class="mb-6 inline-block p-4 rounded-full bg-blue-500/10 border border-blue-500/50">
                <i class="fas fa-terminal text-blue-500 text-3xl"></i>
            </div>
            <h1 class="text-2xl font-bold tracking-[0.5em] mb-8 text-white uppercase">Initialize Link</h1>
            <input type="text" id="username-input" maxlength="15"
                class="w-full bg-transparent border-b-2 border-blue-900 focus:border-blue-500 py-3 px-2 text-center text-xl outline-none transition-all text-blue-400 font-mono"
                placeholder="ENTER CALLSIGN...">
            <button onclick="establishLink()" class="mt-10 px-10 py-3 bg-blue-600 hover:bg-blue-400 text-white font-black tracking-widest uppercase rounded-sm transition-all">
                Access Node
            </button>
        </div>
    </div>

    <div id="alert-modal" class="hidden fixed inset-0 z-[110] flex items-center justify-center bg-black/80 backdrop-blur-md">
        <div class="bg-slate-900 border border-red-500/50 p-8 rounded-2xl max-w-sm w-[90%] text-center shadow-[0_0_50px_rgba(239,68,68,0.2)]">
            <i class="fas fa-triangle-exclamation text-red-500 text-4xl mb-4"></i>
            <h3 class="text-white font-bold uppercase tracking-widest mb-2">System Alert</h3>
            <p id="alert-text" class="text-slate-400 text-sm mb-6"></p>
            <button onclick="closeAlert()" class="w-full py-2 bg-red-500/20 hover:bg-red-500/40 border border-red-500/50 text-red-500 uppercase text-xs font-bold tracking-tighter">Acknowledge</button>
        </div>
    </div>

    <header class="p-4 border-b cyber-border flex items-center justify-between glass">
        <div class="flex items-center gap-3">
            <div class="w-3 h-3 bg-blue-500 rounded-full animate-ping"></div>
            <h2 class="font-bold tracking-tighter text-sm md:text-base uppercase">Node // <span class="text-blue-500">Secure_Comms</span></h2>
        </div>
        <div id="user-tag" class="text-[10px] font-mono text-slate-500 uppercase">Status: Offline</div>
    </header>

    <main id="chat-display" class="flex-1 overflow-y-auto p-4 space-y-6 bg-[url('https://www.transparenttextures.com/patterns/carbon-fibre.png')]">
        <div class="text-center py-10 opacity-30 text-[10px] uppercase tracking-[1em]">Establishing end-to-end encryption</div>
    </main>

    <div id="asset-drawer" class="fixed bottom-[80px] left-0 right-0 glass border-t cyber-border drawer-hide z-40 h-48 overflow-y-auto p-4">
        <div class="flex flex-wrap gap-4 justify-center">
            <img onclick="sendSticker(this.src)" src="https://cdn-icons-png.flaticon.com/512/3062/3062125.png" class="w-16 h-16 hover:scale-110 cursor-pointer transition-all" alt="Sticker">
            <img onclick="sendSticker(this.src)" src="https://cdn-icons-png.flaticon.com/512/3062/3062128.png" class="w-16 h-16 hover:scale-110 cursor-pointer transition-all" alt="Sticker">
            <img onclick="sendSticker(this.src)" src="https://cdn-icons-png.flaticon.com/512/3062/3062134.png" class="w-16 h-16 hover:scale-110 cursor-pointer transition-all" alt="Sticker">
            <div class="w-full flex justify-center gap-6 text-2xl mt-4">
                <span class="cursor-pointer hover:scale-125 transition" onclick="addEmoji('üî•')">üî•</span>
                <span class="cursor-pointer hover:scale-125 transition" onclick="addEmoji('üõ°Ô∏è')">üõ°Ô∏è</span>
                <span class="cursor-pointer hover:scale-125 transition" onclick="addEmoji('‚ö°')">‚ö°</span>
                <span class="cursor-pointer hover:scale-125 transition" onclick="addEmoji('üöÄ')">üöÄ</span>
                <span class="cursor-pointer hover:scale-125 transition" onclick="addEmoji('üíé')">üíé</span>
            </div>
        </div>
    </div>

    <footer class="p-4 glass border-t cyber-border relative z-50">
        <div class="max-w-6xl mx-auto flex items-center gap-3">
            <label class="cursor-pointer p-3 hover:text-blue-400 transition">
                <i class="fas fa-plus"></i>
                <input type="file" id="image-input" class="hidden" accept="image/*">
            </label>

            <button onclick="toggleDrawer()" class="p-3 hover:text-blue-400 transition">
                <i class="fas fa-face-smile"></i>
            </button>

            <input type="text" id="msg-input" placeholder="Secure transmission..." 
                class="flex-1 bg-slate-950/50 border border-slate-800 rounded-full px-5 py-3 text-sm focus:outline-none focus:border-blue-500/50 transition-all">

            <button id="voice-btn" onmousedown="startRecording()" onmouseup="stopRecording()" 
                class="p-3 hover:text-red-500 transition relative">
                <i class="fas fa-microphone"></i>
                <span id="rec-dot" class="hidden absolute top-0 right-0 w-2 h-2 bg-red-500 rounded-full animate-ping"></span>
            </button>

            <button onclick="sendMessage()" class="bg-blue-600 p-3 w-12 h-12 rounded-full hover:bg-blue-400 shadow-lg shadow-blue-500/20">
                <i class="fas fa-paper-plane text-xs"></i>
            </button>
        </div>
    </footer>

    <script>
        let userName = "";
        const chatDisplay = document.getElementById('chat-display');
        const alertModal = document.getElementById('alert-modal');
        const alertText = document.getElementById('alert-text');

        // --- CORE LOGIC ---

        function showAlert(msg) {
            alertText.innerText = msg;
            alertModal.classList.remove('hidden');
        }

        function closeAlert() { alertModal.classList.add('hidden'); }

        function establishLink() {
            const input = document.getElementById('username-input');
            if(input.value.length < 3) {
                showAlert("OPERATOR IDENTITY REJECTED: CALLSIGN TOO SHORT.");
                return;
            }
            userName = input.value.toUpperCase();
            document.getElementById('username-modal').classList.add('hidden');
            document.getElementById('user-tag').innerText = `OPERATOR: ${userName}`;
            appendMessage("SYSTEM", `Link established for ${userName}. Welcome to the node.`, 'system');
        }

        function appendMessage(user, content, type = 'text') {
            const div = document.createElement('div');
            const isMe = user === userName;
            div.className = `flex flex-col ${type === 'system' ? 'items-center' : (isMe ? 'items-end' : 'items-start')} animate-in slide-in-from-bottom-5 duration-300`;
            
            let body = "";
            if(type === 'text') {
                body = `<div class="${isMe ? 'bg-blue-600 text-white' : 'bg-slate-800 text-slate-200'} px-4 py-2 rounded-2xl max-w-[85%] shadow-lg">${content}</div>`;
            } else if(type === 'image') {
                body = `<img src="${content}" class="rounded-xl border-2 border-blue-500/20 max-w-[200px] shadow-2xl">`;
            } else if(type === 'system') {
                body = `<div class="text-[10px] text-blue-500 font-mono border-y border-blue-500/10 py-1 px-4">${content}</div>`;
            } else if(type === 'sticker') {
                body = `<img src="${content}" class="w-32 h-32">`;
            } else if(type === 'voice') {
                body = `<div class="bg-slate-700 px-4 py-2 rounded-2xl flex items-center gap-3"><i class="fas fa-play text-xs"></i> <div class="w-24 h-1 bg-blue-500/30 rounded-full"></div> <span class="text-[10px]">VOICE_MEMO.MP3</span></div>`;
            }

            div.innerHTML = `
                ${type !== 'system' ? `<span class="text-[9px] font-bold text-slate-500 mb-1 ml-2 mr-2">${user}</span>` : ''}
                ${body}
            `;
            chatDisplay.appendChild(div);
            chatDisplay.scrollTop = chatDisplay.scrollHeight;
        }

        // --- FEATURES ---

        function sendMessage() {
            const input = document.getElementById('msg-input');
            if(!input.value.trim()) return;
            appendMessage(userName, input.value);
            input.value = "";
            document.getElementById('asset-drawer').classList.add('drawer-hide');
        }

        function toggleDrawer() {
            document.getElementById('asset-drawer').classList.toggle('drawer-hide');
        }

        function addEmoji(emoji) {
            document.getElementById('msg-input').value += emoji;
        }

        function sendSticker(src) {
            appendMessage(userName, src, 'sticker');
            toggleDrawer();
        }

        // Image Handling
        document.getElementById('image-input').onchange = (e) => {
            const reader = new FileReader();
            reader.onload = (f) => appendMessage(userName, f.target.result, 'image');
            reader.readAsDataURL(e.target.files[0]);
        };

        // Voice Recording Simulation
        let recInterval;
        function startRecording() {
            document.getElementById('rec-dot').classList.remove('hidden');
            // Logic for actual browser MediaRecorder would go here
        }
        function stopRecording() {
            document.getElementById('rec-dot').classList.add('hidden');
            appendMessage(userName, null, 'voice');
        }

        // Enter Key to Send
        document.getElementById('msg-input').onkeypress = (e) => {
            if(e.key === 'Enter') sendMessage();
        };

    </script>
</body>
</html>
